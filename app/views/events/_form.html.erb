<%= form_for(@event) do |f| %>
  <%= render "shared/error_messages", :target => @event %>

  <section>
    <div class='form-group'>
      <%= f.label :url %>
      <%= f.text_field :url %>
    </div>

    <div class='form-group'>
      <%= f.label :venue_id, 'Venue' %>
      <%= f.select :venue_id, venue_select, {:include_blank => true} %>
    </div>
    <div class='form-group'>
      <h4 class="form-group-title">Event Type</h4>

      <% event_type_select.each do |description, help, value| %>
        <label>
          <%= f.radio_button(:event_type, value) %>
          <%= description %>
          <span class="help"><%= help %></span>
        </label>
      <% end %>
    </div>
  </section>

  <% if @event.persisted? %>
    <%= render "events/organiser_link", event: @event %>
  <% end %>

  <section>
    <h3 class='form-section-title'>Social details</h3>
    <div class='form-group'>
      <%= f.label :has_social, "Has social?" %>
      <%= f.check_box :has_social  %>
      <span class='help'>Events with a social dance *must* have a title: this is what gets displayed in the listing</span>
    </div>
    <div class='form-group'>
      <%= f.label :title %>
      <%= f.text_field :title %>
    </div>
    <div class='form-group'>
      <%= f.label :social_organiser_id, 'Social organiser' %>
      <%= f.select :social_organiser_id, organiser_select, { include_blank: '(none)' } %>
    </div>
  </section>

  <section>
    <h3 class='form-section-title'>Class details</h3>
    <div class='form-group'>
      <%= f.label :has_class, "Has a class?" %>
      <%= f.check_box :has_class  %>
      <span class='help'>Events with a class *must* have a class organiser</span>
    </div>
    <div class='form-group'>
      <%= f.label :has_taster, "Has a taster?" %>
      <%= f.check_box :has_taster  %>
    </div>
    <div class='form-group'>
      <%= f.label :class_organiser_id, 'Class organiser' %>
      <%= f.select :class_organiser_id, organiser_select, { include_blank: '(none)' } %>
      <p class='help'>Note: classes don't have names - just locations and organisers</p>
      <p class='help'>The location and organiser name are displayed in the listings.</>
    </div>

    <div class='form-group' id="class-style-selection">
      <h4 class='form-group-title'>Class style</h3>
      <div class='radio-group'>
        <%= radio_button_tag 'class_style_option', 'lindy', @event.class_style.blank? %>
        <%= label_tag :class_style_option_lindy, t('forms.events.default_class_style') %>
      </div>
      <div class='radio-group'>
        <%= radio_button_tag 'class_style_option', 'other', !@event.class_style.blank?, data: { target: 'class-style-group' }%>
        <%= label_tag 'class_style_option_other', 'Other (balboa, shag etc)' %>
      </div>
      <div class='form-group form-group-nested <%= 'hidden' if @event.class_style.blank? %>' id="class-style-group">
        <%= f.label :class_style, "Dance style:" %>
        <%= f.text_field :class_style %>
      </div>
    </div>
    <div class='form-group'>
      <%= f.label :course_length %>
      <%= f.text_field :course_length, :size => 2, :class =>"shortfield" %> weeks
    </div>
  </section>

  <section>
    <h3 class='form-section-title'>When?</h3>
    <div class='form-group'>
      <%= f.label :day %>
      <%= f.select :day, DAYNAMES %>
    </div>
    <div class='form-group'>
      <%= f.label :frequency %>
      <p class='help'>For one-off or intermittent events, use 0</p>
      every <%= f.text_field :frequency, :size => 2, :class =>"shortfield" %> weeks
    </div>
    <div class='form-group'>
      <%= f.label :date_array, 'Upcoming dates' %>
      <p class='help'><%= t('forms.help.dates') %></p>
      <%= f.text_field :date_array, :value => @event.print_dates %>
    </div>
    <div class='form-group'>
      <%= f.label :cancellation_array, 'Cancelled dates' %>
      <p class='help'><%= t('forms.help.dates') %></p>
      <%= f.text_field :cancellation_array, :value => @event.print_cancellations %>
    </div>
    <div class='form-group'>
      <%= f.label :first_date %>
      <p class='help'>The event will only be included in the listings from this date forwards.</p>
      <p class='help'>
        A <span class="new-label">NEW!</span> label will be shown on the listing
        for <%= distance_of_time_in_words(Event::CONSIDERED_NEW_FOR) %> after this date.
      </p>
      <%= f.text_field :first_date, value: @event.first_date.to_s, :size => 10, :class =>"shortfield" %>
    </div>
    <div class='form-group'>
      <%= f.label :last_date %>
      <p class='help'>The event will stop being included in the listings after this date</p>
      <%= f.text_field :last_date, value: @event.last_date.to_s, :size => 10, :class =>"shortfield"%>
    </div>
  </section>

  <div class='form-group actions'>
    <%= f.submit action, class: 'button' %>
    <%= link_to 'Cancel', cancel_path, class: "button button-secondary" %>
  </div>
<% end %>
